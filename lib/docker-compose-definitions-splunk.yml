x-splunk-def:
  &splunk-def
  image: splunk/splunk:latest
  environment:
    - SPLUNK_START_ARGS=--accept-license
    - SPLUNK_HEC_TOKEN=11111111-1111-1111-1111-1111111111113
    - SPLUNK_PASSWORD=changeme
    - SPLUNK_APPS_URL=https://github.com/splunk/ethereum-basics/releases/download/latest/ethereum-basics.tgz,https://splunk-quorum.s3.us-east-2.amazonaws.com/oss-quorum-app-for-splunk_103.tgz
  expose:
    - "8000"
    - "8088"
  healthcheck:
    test: ['CMD', 'curl', '-f', 'http://localhost:8000']
    interval: 5s
    timeout: 5s
    retries: 20
x-ethlogger-def:
  &ethlogger-def
  image: splunkdlt/ethlogger:latest
  environment:
    - ETH_RPC_URL=http://172.16.239.11:8545
    - NETWORK_NAME=quorum
    - START_AT_BLOCK=genesis
    - SPLUNK_HEC_URL=https://172.16.239.200:8088
    - SPLUNK_HEC_TOKEN=11111111-1111-1111-1111-1111111111113
    - SPLUNK_EVENTS_INDEX=main
    - SPLUNK_METRICS_INDEX=metrics
    - SPLUNK_INTERNAL_INDEX=metrics
    - SPLUNK_HEC_REJECT_INVALID_CERTS=false
    - ABI_DIR=/app/abis
    - COLLECT_PENDING_TX=true
    - COLLECT_PEER_INFO=true
    - DEBUG=ethlogger:abi:*
  depends_on:
    - splunk
    - node1
  restart: unless-stopped
x-cadvisor-def:
  &cadvisor-def
  image: google/cadvisor:latest
  command:
    - --storage_driver=statsd
    - --storage_driver_host=172.16.239.200:8125
    - --docker_only=true
  depends_on:
    - splunk
  user: root
x-tx-gen-def:
  &tx-gen-def
  image: splunkdlt/ethereum-transaction-generator
  entrypoint:
    - tail
    - -f
    - /dev/null
x-logging:
  &default-logging
  driver: splunk
  options:
    splunk-token: 11111111-1111-1111-1111-1111111111113
    splunk-url: https://localhost:8088
    splunk-index: logs
    splunk-sourcetype: docker
    splunk-insecureskipverify: "true"
    splunk-verify-connection: "false"
    splunk-format: "raw"
    tag: "{{.Name}}-{{.ID}}"
